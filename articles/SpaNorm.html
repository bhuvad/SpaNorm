<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="SpaNorm">
<title>SpaNorm: Spatially aware library size normalisation • SpaNorm</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="SpaNorm: Spatially aware library size normalisation">
<meta property="og:description" content="SpaNorm">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">SpaNorm</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.99.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/SpaNorm.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/bhuvad/SpaNorm/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>SpaNorm: Spatially aware library size normalisation</h1>
                        <h4 data-toc-skip class="author">Dharmesh D.
Bhuva and Agus Salim</h4>
            
            <h4 data-toc-skip class="date">26 June 2024</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/bhuvad/SpaNorm/blob/HEAD/vignettes/SpaNorm.Rmd" class="external-link"><code>vignettes/SpaNorm.Rmd</code></a></small>
      <div class="d-none name"><code>SpaNorm.Rmd</code></div>
    </div>

    
        <div class="abstract">
      <p class="abstract">Abstract</p>
      <p>This package implements the spatially aware library size
      normalisation algorithm, SpaNorm. SpaNorm normalises out library
      size effects while retaining biology through the modelling of
      smooth functions for each effect. Normalisation is performed in a
      gene- and cell-/spot- specific manner, yielding library size
      adjusted data.</p>
    </div>
    
<div class="section level2">
<h2 id="spanorm">SpaNorm<a class="anchor" aria-label="anchor" href="#spanorm"></a>
</h2>
<p>SpaNorm is a spatially aware library size normalisation method that
removes library size effects, while retaining biology. Library sizes
need to be removed from molecular datasets to allow comparisons across
observations, in this case, across space. Bhuva et al. <span class="citation">(Bhuva et al. 2024)</span> and Atta et al. <span class="citation">(Atta et al. 2024)</span> have shown that standard
single-cell inspired library size normalisation approaches are not
appropriate for spatial molecular datasets as they often remove
biological signals while doing so. This is because library size
confounds biology in spatial molecular data.</p>
<div class="float">
<img src="SpaNormWorkflow.png" alt="The SpaNorm workflow: SpaNorm takes the gene expression data and spatial coordinates as inputs. Using a gene-wise model (e.g., Negative Binomial (NB)), SpaNorm decomposes spatially-smooth variation into those unrelated to library size (LS), representing the underlying true biology and those related to library size. The adjusted data is then produced by keeping only the variation unrelated to library size."><div class="figcaption"><em>The SpaNorm workflow: SpaNorm takes the gene
expression data and spatial coordinates as inputs. Using a gene-wise
model (e.g., Negative Binomial (NB)), SpaNorm decomposes
spatially-smooth variation into those unrelated to library size (LS),
representing the underlying true biology and those related to library
size. The adjusted data is then produced by keeping only the variation
unrelated to library size.</em></div>
</div>
<p>SpaNorm uses a unique approach to spatially constraint modelling
approach to model gene expression (e.g., counts) and remove library size
effects, while retaining biology. It achieves this through three key
innovations:</p>
<ol style="list-style-type: decimal">
<li>Optmial decomposition of spatial variation into spatially smooth
library size associated (technical) and library size independent
(biology) variation using generalized linear models (GLMs).</li>
<li>Computing spatially smooth functions (using thin plate splines) to
represent the gene- and location-/cell-/spot- specific size
factors.</li>
<li>Adjustment of data using percentile adjusted counts (PAC) <span class="citation">(Salim et al. 2022)</span>, as well as other adjustment
approaches (e.g., Pearson).</li>
</ol>
<p>The SpaNorm package can be installed as follows:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"BiocManager"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"BiocManager"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># release version</span></span>
<span><span class="fu">BiocManager</span><span class="fu">::</span><span class="fu"><a href="https://bioconductor.github.io/BiocManager/reference/install.html" class="external-link">install</a></span><span class="op">(</span><span class="st">"SpaNorm"</span><span class="op">)</span></span>
<span><span class="co"># development version from GitHub</span></span>
<span><span class="fu">BiocManager</span><span class="fu">::</span><span class="fu"><a href="https://bioconductor.github.io/BiocManager/reference/install.html" class="external-link">install</a></span><span class="op">(</span><span class="st">"bhuvad/SpaNorm"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="load-count-data">Load count data<a class="anchor" aria-label="anchor" href="#load-count-data"></a>
</h2>
<p>We begin by loading some example 10x Visium data profiling the
dorsolateral prefrontal cortex (DLPFC) of the human brain. The data has
~4,000 spots and covers genome-wide measurements. The example data here
is filtered to remove lowly expressed genes (using
<code>filterGenes(HumanDLPFC, prop = 0.1)</code>). This filtering
retains genes that are expressed in at least 10% of cells.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://bhuvad.github.io/SpaNorm" class="external-link">SpaNorm</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/drighelli/SpatialExperiment" class="external-link">SpatialExperiment</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># load sample data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">HumanDLPFC</span><span class="op">)</span></span>
<span><span class="co"># change gene IDs to gene names</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">HumanDLPFC</span><span class="op">)</span> <span class="op">=</span> <span class="fu">rowData</span><span class="op">(</span><span class="va">HumanDLPFC</span><span class="op">)</span><span class="op">$</span><span class="va">gene_name</span></span>
<span><span class="va">HumanDLPFC</span></span>
<span><span class="co">#&gt; class: SpatialExperiment </span></span>
<span><span class="co">#&gt; dim: 5076 4015 </span></span>
<span><span class="co">#&gt; metadata(0):</span></span>
<span><span class="co">#&gt; assays(1): counts</span></span>
<span><span class="co">#&gt; rownames(5076): NOC2L HES4 ... MT-CYB AC007325.4</span></span>
<span><span class="co">#&gt; rowData names(2): gene_name gene_biotype</span></span>
<span><span class="co">#&gt; colnames(4015): AAACAAGTATCTCCCA-1 AAACACCAATAACTGC-1 ...</span></span>
<span><span class="co">#&gt;   TTGTTTCCATACAACT-1 TTGTTTGTGTAAATTC-1</span></span>
<span><span class="co">#&gt; colData names(3): cell_count sample_id AnnotatedCluster</span></span>
<span><span class="co">#&gt; reducedDimNames(0):</span></span>
<span><span class="co">#&gt; mainExpName: NULL</span></span>
<span><span class="co">#&gt; altExpNames(0):</span></span>
<span><span class="co">#&gt; spatialCoords names(2) : pxl_col_in_fullres pxl_row_in_fullres</span></span>
<span><span class="co">#&gt; imgData names(4): sample_id image_id data scaleFactor</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># plot regions</span></span>
<span><span class="va">p_region</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/SpatialExperiment/man/SpatialExperiment-methods.html" class="external-link">spatialCoords</a></span><span class="op">(</span><span class="va">HumanDLPFC</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="st">"Region"</span> <span class="op">=</span> <span class="va">HumanDLPFC</span><span class="op">$</span><span class="va">AnnotatedCluster</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">pxl_col_in_fullres</span>, <span class="va">pxl_row_in_fullres</span>, colour <span class="op">=</span> <span class="va">Region</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_colour_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Paired"</span>, guide <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html" class="external-link">guide_legend</a></span><span class="op">(</span>override.aes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="fl">15</span>, size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Region"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">custom_theme</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">p_region</span></span></code></pre></div>
<p><img src="SpaNorm_files/figure-html/unnamed-chunk-3-1.png" width="384"></p>
<p>The <code>filterGenes</code> function returns a logical vector
indicating which genes should be kept.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># filter genes expressed in 20% of spots</span></span>
<span><span class="va">keep</span> <span class="op">=</span> <span class="fu"><a href="../reference/filterGenes.html">filterGenes</a></span><span class="op">(</span><span class="va">HumanDLPFC</span>, <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">keep</span><span class="op">)</span></span>
<span><span class="co">#&gt; keep</span></span>
<span><span class="co">#&gt; FALSE  TRUE </span></span>
<span><span class="co">#&gt;  2568  2508</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># subset genes</span></span>
<span><span class="va">HumanDLPFC</span> <span class="op">=</span> <span class="va">HumanDLPFC</span><span class="op">[</span><span class="va">keep</span>, <span class="op">]</span></span></code></pre></div>
<p>The log-transformed raw counts are visualised below for the gene
<em>MOBP</em> which is a marker of oligodendrocytes enriched in the
white matter (WM) <span class="citation">(Maynard et al. 2021)</span>.
Despite being a marker of this region, we see that it is in fact absent
from the white matter region.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/SingleCellExperiment/man/assays.html" class="external-link">logcounts</a></span><span class="op">(</span><span class="va">HumanDLPFC</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log2</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/dge.html" class="external-link">counts</a></span><span class="op">(</span><span class="va">HumanDLPFC</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">p_counts</span> <span class="op">=</span> <span class="fu">plotGeneExpression</span><span class="op">(</span><span class="va">HumanDLPFC</span>, <span class="st">"MOBP"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Counts"</span><span class="op">)</span></span>
<span><span class="va">p_region</span> <span class="op">+</span> <span class="va">p_counts</span></span></code></pre></div>
<p><img src="SpaNorm_files/figure-html/unnamed-chunk-5-1.png" width="720"></p>
</div>
<div class="section level2">
<h2 id="normalise-count-data">Normalise count data<a class="anchor" aria-label="anchor" href="#normalise-count-data"></a>
</h2>
<p>SpaNorm normalises data in two steps: (1) fitting the SpaNorm model
of library sizes; (2) adjusting data using the fit model. A single call
to the <code>SpaNorm()</code> function is enough to run these two steps.
To speed up computation, the model is fit using a smaller proportion of
spots/cells (default is 0.25). The can be modified using the
<code>sample.p</code> parameter.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">36</span><span class="op">)</span></span>
<span><span class="va">HumanDLPFC</span> <span class="op">=</span> <span class="fu">SpaNorm</span><span class="op">(</span><span class="va">HumanDLPFC</span><span class="op">)</span></span>
<span><span class="co">#&gt; (1/2) Fitting SpaNorm model</span></span>
<span><span class="co">#&gt; 1004 cells/spots sampled to fit model</span></span>
<span><span class="co">#&gt; iter:  1, estimating gene-wise dispersion</span></span>
<span><span class="co">#&gt; iter:  1, log-likelihood: -3184656.126744</span></span>
<span><span class="co">#&gt; iter:  1, fitting NB model</span></span>
<span><span class="co">#&gt; iter:  1, iter:  1, log-likelihood: -3184656.126744</span></span>
<span><span class="co">#&gt; iter:  1, iter:  2, log-likelihood: -2562084.797570</span></span>
<span><span class="co">#&gt; iter:  1, iter:  3, log-likelihood: -2442456.409618</span></span>
<span><span class="co">#&gt; iter:  1, iter:  4, log-likelihood: -2404466.307333</span></span>
<span><span class="co">#&gt; iter:  1, iter:  5, log-likelihood: -2388761.293687</span></span>
<span><span class="co">#&gt; iter:  1, iter:  6, log-likelihood: -2383417.595821</span></span>
<span><span class="co">#&gt; iter:  1, iter:  7, log-likelihood: -2381609.482811</span></span>
<span><span class="co">#&gt; iter:  1, iter:  8, log-likelihood: -2380854.439236</span></span>
<span><span class="co">#&gt; iter:  1, iter:  9, log-likelihood: -2380504.664759</span></span>
<span><span class="co">#&gt; iter:  1, iter: 10, log-likelihood: -2380337.045398 (converged)</span></span>
<span><span class="co">#&gt; iter:  2, estimating gene-wise dispersion</span></span>
<span><span class="co">#&gt; iter:  2, log-likelihood: -2377186.824762</span></span>
<span><span class="co">#&gt; iter:  2, fitting NB model</span></span>
<span><span class="co">#&gt; iter:  2, iter:  1, log-likelihood: -2377186.824762</span></span>
<span><span class="co">#&gt; iter:  2, iter:  2, log-likelihood: -2375866.818616</span></span>
<span><span class="co">#&gt; iter:  2, iter:  2, log-likelihood: -2375866.818616</span></span>
<span><span class="co">#&gt; iter:  2, iter:  2, log-likelihood: -2375866.818616</span></span>
<span><span class="co">#&gt; iter:  2, iter:  3, log-likelihood: -2375866.818616 (converged)</span></span>
<span><span class="co">#&gt; iter:  3, estimating gene-wise dispersion</span></span>
<span><span class="co">#&gt; iter:  3, log-likelihood: -2375896.395415</span></span>
<span><span class="co">#&gt; iter:  3, fitting NB model</span></span>
<span><span class="co">#&gt; iter:  3, iter:  1, log-likelihood: -2375896.395415</span></span>
<span><span class="co">#&gt; iter:  3, iter:  1, log-likelihood: -2375896.395415</span></span>
<span><span class="co">#&gt; iter:  3, iter:  1, log-likelihood: -2375896.395415</span></span>
<span><span class="co">#&gt; iter:  3, iter:  2, log-likelihood: -2375896.395415</span></span>
<span><span class="co">#&gt; iter:  3, iter:  2, log-likelihood: -2375896.395415</span></span>
<span><span class="co">#&gt; iter:  3, iter:  2, log-likelihood: -2375896.395415</span></span>
<span><span class="co">#&gt; iter:  3, iter:  3, log-likelihood: -2375896.395415 (converged)</span></span>
<span><span class="co">#&gt; iter:  4, log-likelihood: -2375896.395415 (converged)</span></span>
<span><span class="co">#&gt; (2/2) Normalising data</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">HumanDLPFC</span></span>
<span><span class="co">#&gt; class: SpatialExperiment </span></span>
<span><span class="co">#&gt; dim: 2508 4015 </span></span>
<span><span class="co">#&gt; metadata(1): SpaNorm</span></span>
<span><span class="co">#&gt; assays(2): counts logcounts</span></span>
<span><span class="co">#&gt; rownames(2508): ISG15 SDF4 ... MT-ND6 MT-CYB</span></span>
<span><span class="co">#&gt; rowData names(2): gene_name gene_biotype</span></span>
<span><span class="co">#&gt; colnames(4015): AAACAAGTATCTCCCA-1 AAACACCAATAACTGC-1 ...</span></span>
<span><span class="co">#&gt;   TTGTTTCCATACAACT-1 TTGTTTGTGTAAATTC-1</span></span>
<span><span class="co">#&gt; colData names(3): cell_count sample_id AnnotatedCluster</span></span>
<span><span class="co">#&gt; reducedDimNames(0):</span></span>
<span><span class="co">#&gt; mainExpName: NULL</span></span>
<span><span class="co">#&gt; altExpNames(0):</span></span>
<span><span class="co">#&gt; spatialCoords names(2) : pxl_col_in_fullres pxl_row_in_fullres</span></span>
<span><span class="co">#&gt; imgData names(4): sample_id image_id data scaleFactor</span></span></code></pre></div>
<p>The above output (which can be switched off by setting
<code>verbose = FALSE</code>), shows the two steps of normalisation. In
the model fitting step, 1004 cells/spots are used to fit the negative
binomial (NB) model. Subsequent output shows that this fit is performed
by alternating between estimation of the dispersion parameter and
estimation of the NB parameters by fixing the dispersion. The output
also shows that each intermmediate fit converges, and so does the final
fit. The accuracy of the fit can be controlled by modifying the
tolerance parameter <code>tol</code> (default <code>1e-4</code>).</p>
<p>Next, data is adjusted using the fit model. The following approaches
are implemented for count data:</p>
<ol style="list-style-type: decimal">
<li>
<code>adj.method = "logpac"</code> (default) - percentile adjusted
counts (PAC) which estimates the count for each gene at each
location/spot/cell using a model that does not contain unwanted effects
such as the library size.</li>
<li>
<code>adj.method = "person"</code> - Pearson residuals from
factoring out unwanted effects.</li>
<li>
<code>adj.method = "meanbio"</code> - the mean of each gene at each
location estimated from the biological component of the model.</li>
<li>
<code>adj.method = "medbio"</code> - the median of each gene at each
location estimated from the biological component of the model.</li>
</ol>
<p>These data are stored in the <code>logcounts</code> assay of the
SpatialExperiment object. After normalisation, we see that MOBP is
enriched in the white matter.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p_logpac</span> <span class="op">=</span> <span class="fu">plotGeneExpression</span><span class="op">(</span><span class="va">HumanDLPFC</span>, <span class="st">"MOBP"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"logPAC"</span><span class="op">)</span></span>
<span><span class="va">p_region</span> <span class="op">+</span> <span class="va">p_logpac</span></span></code></pre></div>
<p><img src="SpaNorm_files/figure-html/unnamed-chunk-7-1.png" width="720"></p>
</div>
<div class="section level2">
<h2 id="computing-alternative-adjusments-using-a-precomputed-spanorm-fit">Computing alternative adjusments using a precomputed SpaNorm
fit<a class="anchor" aria-label="anchor" href="#computing-alternative-adjusments-using-a-precomputed-spanorm-fit"></a>
</h2>
<p>As no appropriate slot exists for storing model parameters, we
currently save them in the metadata slot with the name “SpaNorm”. This
also means that subsetting features (i.e., genes) or observatins (i.e.,
cells/spots/loci) does not subset the model. In such an instance, the
SpaNorm function will realise that the model no longer matches the data
and restimates when called. If instead the model is valid for the data,
the existing fit is extracted and reused.</p>
<p>The fit can be manually retrieved as below for users wishing to reuse
the model outside the SpaNorm framework. Otherwise, calling
<code>SpaNorm()</code> on an object containing the fit will
automatically use it.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># manually retrieve model</span></span>
<span><span class="va">fit.spanorm</span> <span class="op">=</span> <span class="fu">metadata</span><span class="op">(</span><span class="va">HumanDLPFC</span><span class="op">)</span><span class="op">$</span><span class="va">SpaNorm</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">fit.spanorm</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "gmean"       "alpha"       "psi"         "loglik"      "loglik.iter"</span></span>
<span><span class="co">#&gt;  [6] "W"           "df.tps"      "sample.p"    "gene.model"  "lambda.a"   </span></span>
<span><span class="co">#&gt; [11] "isbio"</span></span></code></pre></div>
<p>When a valid fit exists in the object, only the adjustment step is
performed. Alternative adjustments can be computed as below and stored
to the <code>logcounts</code> assay.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Pearson residuals</span></span>
<span><span class="va">HumanDLPFC</span> <span class="op">=</span> <span class="fu">SpaNorm</span><span class="op">(</span><span class="va">HumanDLPFC</span>, adj.method <span class="op">=</span> <span class="st">"pearson"</span><span class="op">)</span></span>
<span><span class="va">p_pearson</span> <span class="op">=</span> <span class="fu">plotGeneExpression</span><span class="op">(</span><span class="va">HumanDLPFC</span>, <span class="st">"MOBP"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Pearson"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># meanbio residuals</span></span>
<span><span class="va">HumanDLPFC</span> <span class="op">=</span> <span class="fu">SpaNorm</span><span class="op">(</span><span class="va">HumanDLPFC</span>, adj.method <span class="op">=</span> <span class="st">"meanbio"</span><span class="op">)</span></span>
<span><span class="va">p_meanbio</span> <span class="op">=</span> <span class="fu">plotGeneExpression</span><span class="op">(</span><span class="va">HumanDLPFC</span>, <span class="st">"MOBP"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Mean biology"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># meanbio residuals</span></span>
<span><span class="va">HumanDLPFC</span> <span class="op">=</span> <span class="fu">SpaNorm</span><span class="op">(</span><span class="va">HumanDLPFC</span>, adj.method <span class="op">=</span> <span class="st">"medbio"</span><span class="op">)</span></span>
<span><span class="va">p_medbio</span> <span class="op">=</span> <span class="fu">plotGeneExpression</span><span class="op">(</span><span class="va">HumanDLPFC</span>, <span class="st">"MOBP"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Median biology"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p_region</span> <span class="op">+</span> <span class="va">p_counts</span> <span class="op">+</span> <span class="va">p_logpac</span> <span class="op">+</span> <span class="va">p_pearson</span> <span class="op">+</span> <span class="va">p_meanbio</span> <span class="op">+</span> <span class="va">p_medbio</span> <span class="op">+</span> <span class="fu">plot_layout</span><span class="op">(</span>ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p><img src="SpaNorm_files/figure-html/unnamed-chunk-9-1.png" width="1104"></p>
<p>The mean biology adjustment shows a significant enrichment of the
<em>MOBP</em> gene in the white matter. As the overall counts of this
gene are low in this sample, other methods show less discriminative
power.</p>
</div>
<div class="section level2">
<h2 id="varying-model-complexity">Varying model complexity<a class="anchor" aria-label="anchor" href="#varying-model-complexity"></a>
</h2>
<p>The complexity of the spatial smoothing function is determined by the
<code>df.tps</code> parameter where larger values result in more
complicated functions (default 6).</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># df.tps = 2</span></span>
<span><span class="va">HumanDLPFC_df2</span> <span class="op">=</span> <span class="fu">SpaNorm</span><span class="op">(</span><span class="va">HumanDLPFC</span>, df.tps <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">p_logpac_2</span> <span class="op">=</span> <span class="fu">plotGeneExpression</span><span class="op">(</span><span class="va">HumanDLPFC_df2</span>, <span class="st">"MOBP"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"logPAC (df.tps = 2)"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># df.tps = 6 (default)</span></span>
<span><span class="va">p_logpac_6</span> <span class="op">=</span> <span class="va">p_logpac</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"logPAC (df.tps = 6)"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p_logpac_2</span> <span class="op">+</span> <span class="va">p_logpac_6</span></span></code></pre></div>
<p><img src="SpaNorm_files/figure-html/unnamed-chunk-10-1.png" width="720"></p>
</div>
<div class="section level2">
<h2 id="enhancing-signal">Enhancing signal<a class="anchor" aria-label="anchor" href="#enhancing-signal"></a>
</h2>
<p>As the counts for the MOBP gene are very low, we see artefacts in the
adjusted counts. As we have a model for the genes, we can increase the
signal by adjusting all means by a constant factor. Applying a scale
factor of 4 shows how the adjusted data are more continuous, with
significant enrichment in the white matter.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># scale.factor = 1 (default)</span></span>
<span><span class="va">HumanDLPFC</span> <span class="op">=</span> <span class="fu">SpaNorm</span><span class="op">(</span><span class="va">HumanDLPFC</span>, scale.factor <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">p_logpac_sf1</span> <span class="op">=</span> <span class="fu">plotGeneExpression</span><span class="op">(</span><span class="va">HumanDLPFC</span>, <span class="st">"MOBP"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"logPAC (scale.factor = 1)"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># scale.factor = 4</span></span>
<span><span class="va">HumanDLPFC</span> <span class="op">=</span> <span class="fu">SpaNorm</span><span class="op">(</span><span class="va">HumanDLPFC</span>, scale.factor <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">p_logpac_sf4</span> <span class="op">=</span> <span class="fu">plotGeneExpression</span><span class="op">(</span><span class="va">HumanDLPFC</span>, <span class="st">"MOBP"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"logPAC (scale.factor = 4)"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p_logpac_sf1</span> <span class="op">+</span> <span class="va">p_logpac_sf4</span> <span class="op">+</span> <span class="fu">plot_layout</span><span class="op">(</span>ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="SpaNorm_files/figure-html/unnamed-chunk-11-1.png" width="720"></p>
</div>
<div class="section level2">
<h2 id="session-information">Session information<a class="anchor" aria-label="anchor" href="#session-information"></a>
</h2>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.4.1 (2024-06-14)</span></span>
<span><span class="co">#&gt; Platform: x86_64-pc-linux-gnu</span></span>
<span><span class="co">#&gt; Running under: Ubuntu 22.04.4 LTS</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">#&gt; LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt;  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       </span></span>
<span><span class="co">#&gt;  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   </span></span>
<span><span class="co">#&gt;  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          </span></span>
<span><span class="co">#&gt; [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time zone: UTC</span></span>
<span><span class="co">#&gt; tzcode source: system (glibc)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats4    stats     graphics  grDevices utils     datasets  methods  </span></span>
<span><span class="co">#&gt; [8] base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt;  [1] SpatialExperiment_1.14.0    SingleCellExperiment_1.26.0</span></span>
<span><span class="co">#&gt;  [3] SummarizedExperiment_1.34.0 Biobase_2.64.0             </span></span>
<span><span class="co">#&gt;  [5] GenomicRanges_1.56.1        GenomeInfoDb_1.40.1        </span></span>
<span><span class="co">#&gt;  [7] IRanges_2.38.0              S4Vectors_0.42.0           </span></span>
<span><span class="co">#&gt;  [9] BiocGenerics_0.50.0         MatrixGenerics_1.16.0      </span></span>
<span><span class="co">#&gt; [11] matrixStats_1.3.0           patchwork_1.2.0            </span></span>
<span><span class="co">#&gt; [13] ggplot2_3.5.1               SpaNorm_0.99.0             </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;  [1] tidyselect_1.2.1          viridisLite_0.4.2        </span></span>
<span><span class="co">#&gt;  [3] dplyr_1.1.4               farver_2.1.2             </span></span>
<span><span class="co">#&gt;  [5] fastmap_1.2.0             bluster_1.14.0           </span></span>
<span><span class="co">#&gt;  [7] digest_0.6.36             rsvd_1.0.5               </span></span>
<span><span class="co">#&gt;  [9] lifecycle_1.0.4           cluster_2.1.6            </span></span>
<span><span class="co">#&gt; [11] statmod_1.5.0             magrittr_2.0.3           </span></span>
<span><span class="co">#&gt; [13] compiler_4.4.1            rlang_1.1.4              </span></span>
<span><span class="co">#&gt; [15] sass_0.4.9                tools_4.4.1              </span></span>
<span><span class="co">#&gt; [17] igraph_2.0.3              utf8_1.2.4               </span></span>
<span><span class="co">#&gt; [19] yaml_2.3.8                knitr_1.47               </span></span>
<span><span class="co">#&gt; [21] dqrng_0.4.1               S4Arrays_1.4.1           </span></span>
<span><span class="co">#&gt; [23] labeling_0.4.3            htmlwidgets_1.6.4        </span></span>
<span><span class="co">#&gt; [25] DelayedArray_0.30.1       RColorBrewer_1.1-3       </span></span>
<span><span class="co">#&gt; [27] abind_1.4-5               BiocParallel_1.38.0      </span></span>
<span><span class="co">#&gt; [29] withr_3.0.0               purrr_1.0.2              </span></span>
<span><span class="co">#&gt; [31] desc_1.4.3                grid_4.4.1               </span></span>
<span><span class="co">#&gt; [33] fansi_1.0.6               beachmat_2.20.0          </span></span>
<span><span class="co">#&gt; [35] colorspace_2.1-0          edgeR_4.2.0              </span></span>
<span><span class="co">#&gt; [37] scales_1.3.0              cli_3.6.3                </span></span>
<span><span class="co">#&gt; [39] rmarkdown_2.27            crayon_1.5.3             </span></span>
<span><span class="co">#&gt; [41] ragg_1.3.2                generics_0.1.3           </span></span>
<span><span class="co">#&gt; [43] metapod_1.12.0            httr_1.4.7               </span></span>
<span><span class="co">#&gt; [45] rjson_0.2.21              DelayedMatrixStats_1.26.0</span></span>
<span><span class="co">#&gt; [47] scuttle_1.14.0            cachem_1.1.0             </span></span>
<span><span class="co">#&gt; [49] zlibbioc_1.50.0           splines_4.4.1            </span></span>
<span><span class="co">#&gt; [51] parallel_4.4.1            BiocManager_1.30.23      </span></span>
<span><span class="co">#&gt; [53] XVector_0.44.0            vctrs_0.6.5              </span></span>
<span><span class="co">#&gt; [55] Matrix_1.7-0              jsonlite_1.8.8           </span></span>
<span><span class="co">#&gt; [57] BiocSingular_1.20.0       BiocNeighbors_1.22.0     </span></span>
<span><span class="co">#&gt; [59] irlba_2.3.5.1             systemfonts_1.1.0        </span></span>
<span><span class="co">#&gt; [61] magick_2.8.3              locfit_1.5-9.10          </span></span>
<span><span class="co">#&gt; [63] limma_3.60.3              jquerylib_0.1.4          </span></span>
<span><span class="co">#&gt; [65] glue_1.7.0                pkgdown_2.0.9            </span></span>
<span><span class="co">#&gt; [67] codetools_0.2-20          gtable_0.3.5             </span></span>
<span><span class="co">#&gt; [69] UCSC.utils_1.0.0          ScaledMatrix_1.12.0      </span></span>
<span><span class="co">#&gt; [71] munsell_0.5.1             tibble_3.2.1             </span></span>
<span><span class="co">#&gt; [73] pillar_1.9.0              htmltools_0.5.8.1        </span></span>
<span><span class="co">#&gt; [75] GenomeInfoDbData_1.2.12   R6_2.5.1                 </span></span>
<span><span class="co">#&gt; [77] sparseMatrixStats_1.16.0  textshaping_0.4.0        </span></span>
<span><span class="co">#&gt; [79] evaluate_0.24.0           lattice_0.22-6           </span></span>
<span><span class="co">#&gt; [81] highr_0.11                memoise_2.0.1            </span></span>
<span><span class="co">#&gt; [83] BiocStyle_2.32.1          scran_1.32.0             </span></span>
<span><span class="co">#&gt; [85] bslib_0.7.0               Rcpp_1.0.12              </span></span>
<span><span class="co">#&gt; [87] SparseArray_1.4.8         xfun_0.45                </span></span>
<span><span class="co">#&gt; [89] fs_1.6.4                  prettydoc_0.4.1          </span></span>
<span><span class="co">#&gt; [91] pkgconfig_2.0.3</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-Atta2023" class="csl-entry">
Atta, Lyla, Kalen Clifton, Manjari Anant, Gohta Aihara, and Jean Fan.
2024. <span>“Gene Count Normalization in Single-Cell Imaging-Based
Spatially Resolved Transcriptomics.”</span> <em>bioRxiv</em>. <a href="https://doi.org/10.1101/2023.08.30.555624" class="external-link">https://doi.org/10.1101/2023.08.30.555624</a>.
</div>
<div id="ref-Bhuva2024" class="csl-entry">
Bhuva, Dharmesh D, Chin Wee Tan, Agus Salim, Claire Marceaux, Marie A
Pickering, Jinjin Chen, Malvika Kharbanda, et al. 2024. <span>“Library
Size Confounds Biology in Spatial Transcriptomics Data.”</span>
<em>Genome Biology</em> 25 (1): 99.
</div>
<div id="ref-Maynard2021" class="csl-entry">
Maynard, Kristen R, Leonardo Collado-Torres, Lukas M Weber, Cedric
Uytingco, Brianna K Barry, Stephen R Williams, Joseph L Catallini, et
al. 2021. <span>“Transcriptome-Scale Spatial Gene Expression in the
Human Dorsolateral Prefrontal Cortex.”</span> <em>Nature
Neuroscience</em> 24 (3): 425–36.
</div>
<div id="ref-Salim2022" class="csl-entry">
Salim, Agus, Ramyar Molania, Jianan Wang, Alysha De Livera, Rachel
Thijssen, and Terence P Speed. 2022. <span>“<span class="nocase">RUV-III-NB: normalization of single cell RNA-seq
data</span>.”</span> <em>Nucleic Acids Research</em> 50 (16): e96–96. <a href="https://doi.org/10.1093/nar/gkac486" class="external-link">https://doi.org/10.1093/nar/gkac486</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Agus Salim, Dharmesh D. Bhuva.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
